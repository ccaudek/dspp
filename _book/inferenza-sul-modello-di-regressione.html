<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capitolo 3 Inferenza sul modello di regressione | Data Science per psicologi</title>
  <meta name="description" content="Capitolo 3 Inferenza sul modello di regressione | Data Science per psicologi si propone di fornire un’introduzione all’analisi dei dati psicologici agli studenti del primo anno del Corso di Laurea in Scienze e Tecniche Psicologiche presso l’Università degli Studi di Firenze. Particolare attenzione sarà posta ai seguenti aspetti: l’uso del linguaggio R per lo svolgimento delle analisi statistiche, la rappresentazione grafica dei dati e l’inferenza Bayesiana." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Capitolo 3 Inferenza sul modello di regressione | Data Science per psicologi" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Capitolo 3 Inferenza sul modello di regressione | Data Science per psicologi si propone di fornire un’introduzione all’analisi dei dati psicologici agli studenti del primo anno del Corso di Laurea in Scienze e Tecniche Psicologiche presso l’Università degli Studi di Firenze. Particolare attenzione sarà posta ai seguenti aspetti: l’uso del linguaggio R per lo svolgimento delle analisi statistiche, la rappresentazione grafica dei dati e l’inferenza Bayesiana." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capitolo 3 Inferenza sul modello di regressione | Data Science per psicologi" />
  
  <meta name="twitter:description" content="Capitolo 3 Inferenza sul modello di regressione | Data Science per psicologi si propone di fornire un’introduzione all’analisi dei dati psicologici agli studenti del primo anno del Corso di Laurea in Scienze e Tecniche Psicologiche presso l’Università degli Studi di Firenze. Particolare attenzione sarà posta ai seguenti aspetti: l’uso del linguaggio R per lo svolgimento delle analisi statistiche, la rappresentazione grafica dei dati e l’inferenza Bayesiana." />
  

<meta name="author" content="Corrado Caudek" />


<meta name="date" content="2021-09-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="regressione-lineare-con-stan.html"/>
<link rel="next" href="confronto-tra-due-gruppi-indipendenti.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science per psicologi</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="regr-models-intro.html"><a href="regr-models-intro.html"><i class="fa fa-check"></i><b>1</b> Introduzione alla regressione lineare bayesiana</a>
<ul>
<li class="chapter" data-level="1.1" data-path="regr-models-intro.html"><a href="regr-models-intro.html#la-funzione-lineare"><i class="fa fa-check"></i><b>1.1</b> La funzione lineare</a></li>
<li class="chapter" data-level="1.2" data-path="regr-models-intro.html"><a href="regr-models-intro.html#lerrore-di-misurazione"><i class="fa fa-check"></i><b>1.2</b> L’errore di misurazione</a></li>
<li class="chapter" data-level="1.3" data-path="regr-models-intro.html"><a href="regr-models-intro.html#il-modello-di-regressione-da-una-prospettiva-bayesiana"><i class="fa fa-check"></i><b>1.3</b> Il modello di regressione da una prospettiva bayesiana</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="regr-models-intro.html"><a href="regr-models-intro.html#una-media-specifica-per-ciascuna-osservazione"><i class="fa fa-check"></i><b>1.3.1</b> Una media specifica per ciascuna osservazione</a></li>
<li class="chapter" data-level="1.3.2" data-path="regr-models-intro.html"><a href="regr-models-intro.html#relazione-lineare-tra-la-media-e-il-predittore"><i class="fa fa-check"></i><b>1.3.2</b> Relazione lineare tra la media e il predittore</a></li>
<li class="chapter" data-level="1.3.3" data-path="regr-models-intro.html"><a href="regr-models-intro.html#il-modello-di-regressione-lineare"><i class="fa fa-check"></i><b>1.3.3</b> Il modello di regressione lineare</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="regr-models-intro.html"><a href="regr-models-intro.html#considerazioni-conclusive"><i class="fa fa-check"></i>Considerazioni conclusive</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="regressione-lineare-con-stan.html"><a href="regressione-lineare-con-stan.html"><i class="fa fa-check"></i><b>2</b> Regressione lineare con Stan</a>
<ul>
<li class="chapter" data-level="2.1" data-path="regressione-lineare-con-stan.html"><a href="regressione-lineare-con-stan.html#interpretazione-dei-parametri"><i class="fa fa-check"></i><b>2.1</b> Interpretazione dei parametri</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="regressione-lineare-con-stan.html"><a href="regressione-lineare-con-stan.html#centrare-i-predittori"><i class="fa fa-check"></i><b>2.1.1</b> Centrare i predittori</a></li>
<li class="chapter" data-level="2.1.2" data-path="regressione-lineare-con-stan.html"><a href="regressione-lineare-con-stan.html#rappresentazione-grafica-dellincertezza-della-stima"><i class="fa fa-check"></i><b>2.1.2</b> Rappresentazione grafica dell’incertezza della stima</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="regressione-lineare-con-stan.html"><a href="regressione-lineare-con-stan.html#minimi-quadrati"><i class="fa fa-check"></i><b>2.2</b> Minimi quadrati</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="regressione-lineare-con-stan.html"><a href="regressione-lineare-con-stan.html#massima-verosimiglianza"><i class="fa fa-check"></i><b>2.2.1</b> Massima verosimiglianza</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="inferenza-sul-modello-di-regressione.html"><a href="inferenza-sul-modello-di-regressione.html"><i class="fa fa-check"></i><b>3</b> Inferenza sul modello di regressione</a>
<ul>
<li class="chapter" data-level="3.1" data-path="inferenza-sul-modello-di-regressione.html"><a href="inferenza-sul-modello-di-regressione.html#rappresentazione-grafica-dellincertezza-della-stima-1"><i class="fa fa-check"></i><b>3.1</b> Rappresentazione grafica dell’incertezza della stima</a></li>
<li class="chapter" data-level="3.2" data-path="inferenza-sul-modello-di-regressione.html"><a href="inferenza-sul-modello-di-regressione.html#intervalli-di-credibilità"><i class="fa fa-check"></i><b>3.2</b> Intervalli di credibilità</a></li>
<li class="chapter" data-level="3.3" data-path="inferenza-sul-modello-di-regressione.html"><a href="inferenza-sul-modello-di-regressione.html#rappresentazione-grafica-della-distribuzione-a-posteriori"><i class="fa fa-check"></i><b>3.3</b> Rappresentazione grafica della distribuzione a posteriori</a></li>
<li class="chapter" data-level="3.4" data-path="inferenza-sul-modello-di-regressione.html"><a href="inferenza-sul-modello-di-regressione.html#test-di-ipotesi"><i class="fa fa-check"></i><b>3.4</b> Test di ipotesi</a></li>
<li class="chapter" data-level="3.5" data-path="inferenza-sul-modello-di-regressione.html"><a href="inferenza-sul-modello-di-regressione.html#regressione-robusta"><i class="fa fa-check"></i><b>3.5</b> Regressione robusta</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="confronto-tra-due-gruppi-indipendenti.html"><a href="confronto-tra-due-gruppi-indipendenti.html"><i class="fa fa-check"></i><b>4</b> Confronto tra due gruppi indipendenti</a>
<ul>
<li class="chapter" data-level="4.1" data-path="confronto-tra-due-gruppi-indipendenti.html"><a href="confronto-tra-due-gruppi-indipendenti.html#regressione-lineare-con-una-variabile-dicotomica"><i class="fa fa-check"></i><b>4.1</b> Regressione lineare con una variabile dicotomica</a></li>
<li class="chapter" data-level="4.2" data-path="confronto-tra-due-gruppi-indipendenti.html"><a href="confronto-tra-due-gruppi-indipendenti.html#la-dimensione-delleffetto"><i class="fa fa-check"></i><b>4.2</b> La dimensione dell’effetto</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science per psicologi</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inferenza-sul-modello-di-regressione" class="section level1" number="3">
<h1><span class="header-section-number">Capitolo 3</span> Inferenza sul modello di regressione</h1>
<p>I minimi quadrati o la massima verosimiglianza trovano i parametri che meglio si adattano ai dati (secondo un criterio prestabilito), ma senza altrimenti vincolare la stima. Ma di solito il ricercatore dispone di informazioni preliminari sui parametri del modello. L’inferenza bayesiana produce un compromesso tra tali informazioni precedenti e i dati, moltiplicando la funzione di verosimiglianza con una distribuzione a priori che codifica probabilisticamente le informazioni sui parametri possedute dal ricercatore prima di avere osservato i dati. Il prodotto della verosimiglianza <a href="regressione-lineare-con-stan.html#eq:ml-reg">(2.5)</a> e della distribuzione a priori è chiamata distribuzione a posteriori e riassume la nostra conoscenza del parametro <em>dopo</em> aver visto i dati.</p>
<p>La soluzione dei minimi quadrati è una stima puntuale che rappresenta il vettore dei coefficienti che fornisce il miglior adattamento complessivo ai dati. Per un modello bayesiano, la stima puntuale corrispondente è la <em>moda a posteriori</em>, che fornisce il miglior adattamento complessivo ai dati e alla distribuzione a priori. Si noti inoltre che la stima dei minimi quadrati (o di massima verosimiglianza) corrisponde alla moda a posteriori di un modello bayesiano con una distribuzione a priori uniforme.</p>
<div id="rappresentazione-grafica-dellincertezza-della-stima-1" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Rappresentazione grafica dell’incertezza della stima</h2>
<p>Un primo modo per rappresentare l’incertezza dell’inferenza in un ottica bayesiana è quella di rappresentare graficamente la retta di regressione. Continuando con l’esempio descritto nel Capitolo precedente (ovvero, i dati <code>kid_score</code> e <code>mom_iq</code> centrati), usando la funzione <code>extract()</code>, salvo le stime a posteriori dei parametri in formato <code>list</code>:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="inferenza-sul-modello-di-regressione.html#cb25-1" aria-hidden="true" tabindex="-1"></a>stanfit <span class="ot">&lt;-</span> rstan<span class="sc">::</span><span class="fu">read_stan_csv</span>(fit2<span class="sc">$</span><span class="fu">output_files</span>())</span>
<span id="cb25-2"><a href="inferenza-sul-modello-di-regressione.html#cb25-2" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> <span class="fu">extract</span>(stanfit)</span></code></pre></div>
<p>Un diagramma a dispersione dei dati con sovrapposto il valore atteso della <span class="math inline">\(y\)</span> in base al modello bayesiano si ottiene nel modo seguente:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="inferenza-sul-modello-di-regressione.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb26-2"><a href="inferenza-sul-modello-di-regressione.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>kid_score <span class="sc">~</span> <span class="fu">I</span>(df<span class="sc">$</span>mom_iq <span class="sc">-</span> <span class="fu">mean</span>(df<span class="sc">$</span>mom_iq)), </span>
<span id="cb26-3"><a href="inferenza-sul-modello-di-regressione.html#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb26-4"><a href="inferenza-sul-modello-di-regressione.html#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;mom_iq (centered)&quot;</span>,</span>
<span id="cb26-5"><a href="inferenza-sul-modello-di-regressione.html#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;kid_score&quot;</span></span>
<span id="cb26-6"><a href="inferenza-sul-modello-di-regressione.html#cb26-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-7"><a href="inferenza-sul-modello-di-regressione.html#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">mean</span>(posterior<span class="sc">$</span>alpha), <span class="fu">mean</span>(posterior<span class="sc">$</span>beta), <span class="at">col =</span> <span class="dv">6</span>, <span class="at">lw =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="053_reglin3_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Un modo per visualizzare l’incertezza della stima della retta di regressione è quello di tracciare molteplici rette di regressione, ciascuna delle quali definita da una diversa stima dei parametri <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span> che vengono estratti a caso dalle rispettive distribuzioni a posteriori.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="inferenza-sul-modello-di-regressione.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb27-2"><a href="inferenza-sul-modello-di-regressione.html#cb27-2" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>kid_score <span class="sc">~</span> <span class="fu">I</span>(df<span class="sc">$</span>mom_iq <span class="sc">-</span> <span class="fu">mean</span>(df<span class="sc">$</span>mom_iq)), </span>
<span id="cb27-3"><a href="inferenza-sul-modello-di-regressione.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb27-4"><a href="inferenza-sul-modello-di-regressione.html#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;mom_iq (centered)&quot;</span>,</span>
<span id="cb27-5"><a href="inferenza-sul-modello-di-regressione.html#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;kid_score&quot;</span></span>
<span id="cb27-6"><a href="inferenza-sul-modello-di-regressione.html#cb27-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-7"><a href="inferenza-sul-modello-di-regressione.html#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>) {</span>
<span id="cb27-8"><a href="inferenza-sul-modello-di-regressione.html#cb27-8" aria-hidden="true" tabindex="-1"></a> <span class="fu">abline</span>(posterior<span class="sc">$</span>alpha[i], posterior<span class="sc">$</span>beta[i], <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb27-9"><a href="inferenza-sul-modello-di-regressione.html#cb27-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-10"><a href="inferenza-sul-modello-di-regressione.html#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">mean</span>(posterior<span class="sc">$</span>alpha), <span class="fu">mean</span>(posterior<span class="sc">$</span>beta), <span class="at">col =</span> <span class="dv">6</span>, <span class="at">lw =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="053_reglin3_files/figure-html/unnamed-chunk-5-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="intervalli-di-credibilità" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Intervalli di credibilità</h2>
<p>L’incertezza inferenziale sui parametri può essere rappresentata mediante gli <em>intervalli di credibilità</em>, ovvero gli intervalli che contengono la quota desiderata (es., il 95%) della distribuzione a posteriori.</p>
<p>Gli intervalli di credibilità al 95% si ottengono nel modo seguente:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="inferenza-sul-modello-di-regressione.html#cb28-1" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> <span class="fu">extract</span>(stanfit)</span>
<span id="cb28-2"><a href="inferenza-sul-modello-di-regressione.html#cb28-2" aria-hidden="true" tabindex="-1"></a>rstantools<span class="sc">::</span><span class="fu">posterior_interval</span>(<span class="fu">as.matrix</span>(stanfit), <span class="at">prob =</span> <span class="fl">0.95</span>)</span>
<span id="cb28-3"><a href="inferenza-sul-modello-di-regressione.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                    2.5%         97.5%</span></span>
<span id="cb28-4"><a href="inferenza-sul-modello-di-regressione.html#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha_std   -0.08381793    0.08454522</span></span>
<span id="cb28-5"><a href="inferenza-sul-modello-di-regressione.html#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta_std     0.36326418    0.53240170</span></span>
<span id="cb28-6"><a href="inferenza-sul-modello-di-regressione.html#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma_std    0.84043118    0.95801893</span></span>
<span id="cb28-7"><a href="inferenza-sul-modello-di-regressione.html#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha       85.08649000   88.52285250</span></span>
<span id="cb28-8"><a href="inferenza-sul-modello-di-regressione.html#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta         0.49429853    0.72444565</span></span>
<span id="cb28-9"><a href="inferenza-sul-modello-di-regressione.html#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma       17.15376250   19.55382000</span></span>
<span id="cb28-10"><a href="inferenza-sul-modello-di-regressione.html#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lp__      -172.82802500 -168.24900000</span></span></code></pre></div>
<p>Un grafico che riporta l’intervallo di credibilità ai livelli di probabilità desiderati per <span class="math inline">\(\beta\)</span> si ottiene con le seguenti istruzioni:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="inferenza-sul-modello-di-regressione.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(</span>
<span id="cb29-2"><a href="inferenza-sul-modello-di-regressione.html#cb29-2" aria-hidden="true" tabindex="-1"></a>  fit2<span class="sc">$</span><span class="fu">draws</span>(<span class="fu">c</span>(<span class="st">&quot;beta&quot;</span>)),</span>
<span id="cb29-3"><a href="inferenza-sul-modello-di-regressione.html#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> <span class="fl">0.8</span>,</span>
<span id="cb29-4"><a href="inferenza-sul-modello-di-regressione.html#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob_outer =</span> <span class="fl">0.95</span></span>
<span id="cb29-5"><a href="inferenza-sul-modello-di-regressione.html#cb29-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="053_reglin3_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Per i parametri ottenuti analizzando i dati standardizzati, abbiamo</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="inferenza-sul-modello-di-regressione.html#cb30-1" aria-hidden="true" tabindex="-1"></a>stanfit <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="inferenza-sul-modello-di-regressione.html#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mcmc_intervals</span>(</span>
<span id="cb30-3"><a href="inferenza-sul-modello-di-regressione.html#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;alpha_std&quot;</span>, <span class="st">&quot;beta_std&quot;</span>, <span class="st">&quot;sigma_std&quot;</span>), </span>
<span id="cb30-4"><a href="inferenza-sul-modello-di-regressione.html#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">prob =</span> <span class="fl">0.8</span>,</span>
<span id="cb30-5"><a href="inferenza-sul-modello-di-regressione.html#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">prob_outer =</span> <span class="fl">0.95</span></span>
<span id="cb30-6"><a href="inferenza-sul-modello-di-regressione.html#cb30-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="053_reglin3_files/figure-html/unnamed-chunk-8-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="rappresentazione-grafica-della-distribuzione-a-posteriori" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Rappresentazione grafica della distribuzione a posteriori</h2>
<p>Ma non c’è niente di “magico” o necessario relativamente al livello di 0.95: il valore di 0.95 è arbitrario. Sono possibili tantissime altre soglie per quantificare la nostra incertezza: alcuni ricercatori usano il livello di 0.89, altri quello di 0.5. Se l’obiettivo è quello di descrivere il livello della nostra incertezza relativamente alla stima del parametro, allora dobbiamo riconoscere che la nostra incertezza è descritta dall’<em>intera</em> distribuzione a posteriori. Per cui il metodo più semplice, più diretto e più completo per descrivere la nostra incertezza rispetto alla stima dei parametri è quello di riportare graficamente tutta la distribuzione a posteriori.</p>
<p>Una rappresentazione della distribuzione a posteriori dei parametri del modello che stiamo discutendo si ottiene nel modo seguente:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="inferenza-sul-modello-di-regressione.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stan_dens</span>(stanfit, <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sigma&quot;</span>))</span></code></pre></div>
<p><img src="053_reglin3_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="test-di-ipotesi" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Test di ipotesi</h2>
<p>È facile valutare ipotesi direzionali. Per esempio, la probabilità di <span class="math inline">\(\hat{\beta} &gt; 0\)</span> è</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="inferenza-sul-modello-di-regressione.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(posterior<span class="sc">$</span>beta <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">/</span> <span class="fu">length</span>(posterior<span class="sc">$</span>beta)</span>
<span id="cb32-2"><a href="inferenza-sul-modello-di-regressione.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1</span></span></code></pre></div>
</div>
<div id="regressione-robusta" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Regressione robusta</h2>
<p>Spesso i ricercatori devono affrontare il problema degli outlier: un modello statistico basato sulla distribuzione Normale produrrà delle stime dei parametri che non si generalizzano ad altri campioni di dati (ovvero, campioni outlier con le stesse proprietà come nel campione esaminato). Il metodo tradizoinale per affrontare questo problema è quello di eliminare gli outlier prima di eseguire l’analisi statistica. Questo approccio ha però il problema che il criterio utilizzato per eliminare gli outlier, quale esso sia, non può che essere arbitrario. Dunque, usando criteri diversi per eliminare gli outlier i ricercatori finiscno per trovare risultati diversi.</p>
<p>Questo problema trova una semplice soluzione se viene usato l’approccio bayesiano. Nel modello di regressione che abbiamo dicusso finora è stato ipotizzato che gli errori seguono la distribuzione Normale. Per un modello formulato in questi termini, la presenza di solo un valore anomalo e influente può avere un effetto drammatico sulle stime dei parametri. Per fare un esempio, introduco nel set dei dati un singlo valore anomalo:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="inferenza-sul-modello-di-regressione.html#cb33-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> df</span>
<span id="cb33-2"><a href="inferenza-sul-modello-di-regressione.html#cb33-2" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>kid_score[<span class="dv">434</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">500</span></span>
<span id="cb33-3"><a href="inferenza-sul-modello-di-regressione.html#cb33-3" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>mom_iq[<span class="dv">434</span>] <span class="ot">&lt;-</span> <span class="dv">140</span></span></code></pre></div>
<p>Per comodità, calcoliamo le stime di <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span> con il metodo dei minimi quadrati (i risultati sono identici a quelli di un modello bayesiano normale con distribuzioni a priori vagamente informative). Sappiamo che, nel campione originari di dati, <span class="math inline">\(\hat{\beta} \approx 0.6\)</span>. In presenza di un solo outlier troviamo che</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="inferenza-sul-modello-di-regressione.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(kid_score <span class="sc">~</span> mom_iq, <span class="at">data =</span> df2))</span>
<span id="cb34-2"><a href="inferenza-sul-modello-di-regressione.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-3"><a href="inferenza-sul-modello-di-regressione.html#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-4"><a href="inferenza-sul-modello-di-regressione.html#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = kid_score ~ mom_iq, data = df2)</span></span>
<span id="cb34-5"><a href="inferenza-sul-modello-di-regressione.html#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-6"><a href="inferenza-sul-modello-di-regressione.html#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb34-7"><a href="inferenza-sul-modello-di-regressione.html#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb34-8"><a href="inferenza-sul-modello-di-regressione.html#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -599.95  -11.00    4.69   13.64   47.77 </span></span>
<span id="cb34-9"><a href="inferenza-sul-modello-di-regressione.html#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-10"><a href="inferenza-sul-modello-di-regressione.html#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb34-11"><a href="inferenza-sul-modello-di-regressione.html#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb34-12"><a href="inferenza-sul-modello-di-regressione.html#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  49.1880    11.0665   4.445 1.12e-05 ***</span></span>
<span id="cb34-13"><a href="inferenza-sul-modello-di-regressione.html#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mom_iq        0.3626     0.1093   3.317 0.000987 ***</span></span>
<span id="cb34-14"><a href="inferenza-sul-modello-di-regressione.html#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb34-15"><a href="inferenza-sul-modello-di-regressione.html#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb34-16"><a href="inferenza-sul-modello-di-regressione.html#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb34-17"><a href="inferenza-sul-modello-di-regressione.html#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-18"><a href="inferenza-sul-modello-di-regressione.html#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 34.38 on 432 degrees of freedom</span></span>
<span id="cb34-19"><a href="inferenza-sul-modello-di-regressione.html#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.02483,    Adjusted R-squared:  0.02258 </span></span>
<span id="cb34-20"><a href="inferenza-sul-modello-di-regressione.html#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic:    11 on 1 and 432 DF,  p-value: 0.0009872</span></span></code></pre></div>
<p>
la stima di <span class="math inline">\(\beta\)</span> viene drammaticamente ridotta (di quasi la metà!).</p>
<p>Un modello che assume una distribuzione Normale dei residui non è l’unico possibile. È altrettanto valido un modello che ipotizza che i residui seguano una diversa distribuzione di densità. Per esempio, la distribuzione <span class="math inline">\(t\)</span> di Student con un piccolo numero di gradi di libertà. Una caratteristica della <span class="math inline">\(t\)</span> di Student è che le code della distribuzione contengono una massa di probabilità maggiore della Normale. Ciò fornisce alla <span class="math inline">\(t\)</span> di Student la possibilità di “rendere conto” della presenza di osservazioni lontane dalla media della distribuzione. In altri termini, se usiamo la <span class="math inline">\(t\)</span> di Student quale distribuzione dei residui in modello di regressione, ci aspettiamo che le stime dei parametri risultino meno influenzate dalla presenza di outlier di quanto avvenga nel modello Normale.</p>
<p>Per verificare questa intuizione, modifichiamo il codice Stan del modello usato in precedenza. L’unico cambiamento riguarda il fatto che, in questo caso, la distribuzione della <span class="math inline">\(y\)</span> viene ipotizzata seguire una <span class="math inline">\(t\)</span> di Student con un numero <span class="math inline">\(\nu\)</span> gradi di libertà stimato dal modello: <code>student_t(nu, mu, sigma)</code>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="inferenza-sul-modello-di-regressione.html#cb35-1" aria-hidden="true" tabindex="-1"></a>modelString <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb35-2"><a href="inferenza-sul-modello-di-regressione.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb35-3"><a href="inferenza-sul-modello-di-regressione.html#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; N;</span></span>
<span id="cb35-4"><a href="inferenza-sul-modello-di-regressione.html#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[N] y;</span></span>
<span id="cb35-5"><a href="inferenza-sul-modello-di-regressione.html#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[N] x;</span></span>
<span id="cb35-6"><a href="inferenza-sul-modello-di-regressione.html#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb35-7"><a href="inferenza-sul-modello-di-regressione.html#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="st">transformed data {</span></span>
<span id="cb35-8"><a href="inferenza-sul-modello-di-regressione.html#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[N] x_std;</span></span>
<span id="cb35-9"><a href="inferenza-sul-modello-di-regressione.html#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[N] y_std;</span></span>
<span id="cb35-10"><a href="inferenza-sul-modello-di-regressione.html#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="st">  x_std = (x - mean(x)) / sd(x);</span></span>
<span id="cb35-11"><a href="inferenza-sul-modello-di-regressione.html#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="st">  y_std = (y - mean(y)) / sd(y);</span></span>
<span id="cb35-12"><a href="inferenza-sul-modello-di-regressione.html#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb35-13"><a href="inferenza-sul-modello-di-regressione.html#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb35-14"><a href="inferenza-sul-modello-di-regressione.html#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="st">  real alpha_std;</span></span>
<span id="cb35-15"><a href="inferenza-sul-modello-di-regressione.html#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="st">  real beta_std;</span></span>
<span id="cb35-16"><a href="inferenza-sul-modello-di-regressione.html#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma_std;</span></span>
<span id="cb35-17"><a href="inferenza-sul-modello-di-regressione.html#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=1&gt; nu;    // degrees of freedom is constrained &gt;1</span></span>
<span id="cb35-18"><a href="inferenza-sul-modello-di-regressione.html#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb35-19"><a href="inferenza-sul-modello-di-regressione.html#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb35-20"><a href="inferenza-sul-modello-di-regressione.html#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="st">  alpha_std ~ normal(0, 2);</span></span>
<span id="cb35-21"><a href="inferenza-sul-modello-di-regressione.html#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="st">  beta_std ~ normal(0, 2);</span></span>
<span id="cb35-22"><a href="inferenza-sul-modello-di-regressione.html#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="st">  sigma_std ~ cauchy(0, 2);</span></span>
<span id="cb35-23"><a href="inferenza-sul-modello-di-regressione.html#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="st">  nu ~ gamma(2, 0.1);   // Juárez and Steel(2010)</span></span>
<span id="cb35-24"><a href="inferenza-sul-modello-di-regressione.html#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="st">  y_std ~ student_t(nu, alpha_std + beta_std * x_std, sigma_std);</span></span>
<span id="cb35-25"><a href="inferenza-sul-modello-di-regressione.html#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb35-26"><a href="inferenza-sul-modello-di-regressione.html#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb35-27"><a href="inferenza-sul-modello-di-regressione.html#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="st">  real alpha;</span></span>
<span id="cb35-28"><a href="inferenza-sul-modello-di-regressione.html#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="st">  real beta;</span></span>
<span id="cb35-29"><a href="inferenza-sul-modello-di-regressione.html#cb35-29" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma;</span></span>
<span id="cb35-30"><a href="inferenza-sul-modello-di-regressione.html#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="st">  alpha = sd(y) * (alpha_std - beta_std * mean(x) / sd(x))</span></span>
<span id="cb35-31"><a href="inferenza-sul-modello-di-regressione.html#cb35-31" aria-hidden="true" tabindex="-1"></a><span class="st">           + mean(y);</span></span>
<span id="cb35-32"><a href="inferenza-sul-modello-di-regressione.html#cb35-32" aria-hidden="true" tabindex="-1"></a><span class="st">  beta = beta_std * sd(y) / sd(x);</span></span>
<span id="cb35-33"><a href="inferenza-sul-modello-di-regressione.html#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="st">  sigma = sd(y) * sigma_std;</span></span>
<span id="cb35-34"><a href="inferenza-sul-modello-di-regressione.html#cb35-34" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb35-35"><a href="inferenza-sul-modello-di-regressione.html#cb35-35" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb35-36"><a href="inferenza-sul-modello-di-regressione.html#cb35-36" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(modelString, <span class="at">con =</span> <span class="st">&quot;code/simpleregstdrobust.stan&quot;</span>)</span></code></pre></div>
<p>
Costruiamo la lista dei dati usando il data.frame <code>df2</code> che include l’outlier:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="inferenza-sul-modello-di-regressione.html#cb36-1" aria-hidden="true" tabindex="-1"></a>data3_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb36-2"><a href="inferenza-sul-modello-di-regressione.html#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">length</span>(df2<span class="sc">$</span>kid_score),</span>
<span id="cb36-3"><a href="inferenza-sul-modello-di-regressione.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> df2<span class="sc">$</span>kid_score,</span>
<span id="cb36-4"><a href="inferenza-sul-modello-di-regressione.html#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> df2<span class="sc">$</span>mom_iq <span class="sc">-</span> <span class="fu">mean</span>(df2<span class="sc">$</span>mom_iq)</span>
<span id="cb36-5"><a href="inferenza-sul-modello-di-regressione.html#cb36-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>
Adattiamo il modello di regressione robusta ai dati:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="inferenza-sul-modello-di-regressione.html#cb37-1" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;code&quot;</span>, <span class="st">&quot;simpleregstdrobust.stan&quot;</span>)</span>
<span id="cb37-2"><a href="inferenza-sul-modello-di-regressione.html#cb37-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file)</span>
<span id="cb37-3"><a href="inferenza-sul-modello-di-regressione.html#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="inferenza-sul-modello-di-regressione.html#cb37-4" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb37-5"><a href="inferenza-sul-modello-di-regressione.html#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data3_list,</span>
<span id="cb37-6"><a href="inferenza-sul-modello-di-regressione.html#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> 4000L,</span>
<span id="cb37-7"><a href="inferenza-sul-modello-di-regressione.html#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> 2000L,</span>
<span id="cb37-8"><a href="inferenza-sul-modello-di-regressione.html#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> SEED,</span>
<span id="cb37-9"><a href="inferenza-sul-modello-di-regressione.html#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> 4L,</span>
<span id="cb37-10"><a href="inferenza-sul-modello-di-regressione.html#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel_chains =</span> 2L,</span>
<span id="cb37-11"><a href="inferenza-sul-modello-di-regressione.html#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb37-12"><a href="inferenza-sul-modello-di-regressione.html#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin =</span> <span class="dv">1</span></span>
<span id="cb37-13"><a href="inferenza-sul-modello-di-regressione.html#cb37-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>
Esaminando le stime dei parametri</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="inferenza-sul-modello-di-regressione.html#cb38-1" aria-hidden="true" tabindex="-1"></a>fit4<span class="sc">$</span><span class="fu">summary</span>(<span class="fu">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;nu&quot;</span>))</span>
<span id="cb38-2"><a href="inferenza-sul-modello-di-regressione.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 4 × 10</span></span>
<span id="cb38-3"><a href="inferenza-sul-modello-di-regressione.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   variable   mean median     sd    mad     q5    q95  rhat</span></span>
<span id="cb38-4"><a href="inferenza-sul-modello-di-regressione.html#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb38-5"><a href="inferenza-sul-modello-di-regressione.html#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 alpha    87.8   87.8   0.887  0.899  86.3   89.3    1.00</span></span>
<span id="cb38-6"><a href="inferenza-sul-modello-di-regressione.html#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 beta      0.603  0.603 0.0585 0.0577  0.506  0.698  1.00</span></span>
<span id="cb38-7"><a href="inferenza-sul-modello-di-regressione.html#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 sigma    15.9   15.9   0.806  0.812  14.6   17.3    1.00</span></span>
<span id="cb38-8"><a href="inferenza-sul-modello-di-regressione.html#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 nu        5.58   5.44  1.15   1.11    3.94   7.65   1.00</span></span>
<span id="cb38-9"><a href="inferenza-sul-modello-di-regressione.html#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 2 more variables: ess_bulk &lt;dbl&gt;, ess_tail &lt;dbl&gt;</span></span></code></pre></div>
<p>
notiamo che la stima di <span class="math inline">\(\beta\)</span> è rimasta praticamente immutata. La regressione “robusta” non risente dunque della presenza degli outlier.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regressione-lineare-con-stan.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="confronto-tra-due-gruppi-indipendenti.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/053_reglin3.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Data Science per psicologi.pdf", "Data Science per psicologi.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
