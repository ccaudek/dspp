<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capitolo 2 Modello bayesiano Normale-Normale | Data Science per psicologi</title>
  <meta name="description" content="Capitolo 2 Modello bayesiano Normale-Normale | Data Science per psicologi si propone di fornire un’introduzione all’analisi dei dati psicologici agli studenti del primo anno del Corso di Laurea in Scienze e Tecniche Psicologiche presso l’Università degli Studi di Firenze. Particolare attenzione sarà posta ai seguenti aspetti: l’uso del linguaggio R per lo svolgimento delle analisi statistiche, la rappresentazione grafica dei dati e l’inferenza Bayesiana." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Capitolo 2 Modello bayesiano Normale-Normale | Data Science per psicologi" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Capitolo 2 Modello bayesiano Normale-Normale | Data Science per psicologi si propone di fornire un’introduzione all’analisi dei dati psicologici agli studenti del primo anno del Corso di Laurea in Scienze e Tecniche Psicologiche presso l’Università degli Studi di Firenze. Particolare attenzione sarà posta ai seguenti aspetti: l’uso del linguaggio R per lo svolgimento delle analisi statistiche, la rappresentazione grafica dei dati e l’inferenza Bayesiana." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capitolo 2 Modello bayesiano Normale-Normale | Data Science per psicologi" />
  
  <meta name="twitter:description" content="Capitolo 2 Modello bayesiano Normale-Normale | Data Science per psicologi si propone di fornire un’introduzione all’analisi dei dati psicologici agli studenti del primo anno del Corso di Laurea in Scienze e Tecniche Psicologiche presso l’Università degli Studi di Firenze. Particolare attenzione sarà posta ai seguenti aspetti: l’uso del linguaggio R per lo svolgimento delle analisi statistiche, la rappresentazione grafica dei dati e l’inferenza Bayesiana." />
  

<meta name="author" content="Corrado Caudek" />


<meta name="date" content="2021-09-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>

<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science per psicologi</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> url: your book url like <span>https://bookdown.org/yihui/bookdown</span></a></li>
<li class="chapter" data-level="2" data-path="modello-bayesiano-normale-normale.html"><a href="modello-bayesiano-normale-normale.html"><i class="fa fa-check"></i><b>2</b> Modello bayesiano Normale-Normale</a>
<ul>
<li class="chapter" data-level="2.1" data-path="modello-bayesiano-normale-normale.html"><a href="modello-bayesiano-normale-normale.html#distribuzione-normale-normale-con-varianza-nota"><i class="fa fa-check"></i><b>2.1</b> Distribuzione Normale-Normale con varianza nota</a></li>
<li class="chapter" data-level="2.2" data-path="modello-bayesiano-normale-normale.html"><a href="modello-bayesiano-normale-normale.html#il-modello-normale-con-stan"><i class="fa fa-check"></i><b>2.2</b> Il modello Normale con Stan</a></li>
<li class="chapter" data-level="2.3" data-path="modello-bayesiano-normale-normale.html"><a href="modello-bayesiano-normale-normale.html#il-modello-normale-con-quap"><i class="fa fa-check"></i><b>2.3</b> Il modello normale con <code>quap()</code></a></li>
<li class="chapter" data-level="2.4" data-path="modello-bayesiano-normale-normale.html"><a href="modello-bayesiano-normale-normale.html#il-modello-normale-con-brm"><i class="fa fa-check"></i><b>2.4</b> Il modello normale con <code>brm()</code></a></li>
<li class="chapter" data-level="" data-path="modello-bayesiano-normale-normale.html"><a href="modello-bayesiano-normale-normale.html#considerazioni-conclusive"><i class="fa fa-check"></i>Considerazioni conclusive</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science per psicologi</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modello-bayesiano-normale-normale" class="section level1" number="2">
<h1><span class="header-section-number">Capitolo 2</span> Modello bayesiano Normale-Normale</h1>
<div id="distribuzione-normale-normale-con-varianza-nota" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Distribuzione Normale-Normale con varianza nota</h2>
<p>Per <span class="math inline">\(\sigma^2\)</span> nota, la v.c. Normale è distribuzione a priori coniugata della v.c. Normale. Siano <span class="math inline">\(Y_1, \dots, Y_n\)</span> <span class="math inline">\(n\)</span> variabili casuali i.i.d. che seguono la distribuzione Normale:</p>
<p><span class="math display">\[
Y_1, \dots, Y_n  \stackrel{iid}{\sim} \mathcal{N}(\mu, \sigma).
\]</span>
Si vuole stimare <span class="math inline">\(\mu\)</span> sulla base di <span class="math inline">\(n\)</span> osservazioni <span class="math inline">\(y_1, \dots, y_n\)</span>. Considereremo qui solamente il caso in cui <span class="math inline">\(\sigma^2\)</span> sia supposta perfettamente nota.</p>
<p>Ricordiamo che la densità di una Normale è
<span class="math display">\[
p(y_i \mid \mu, \sigma) = \frac{1}{{\sigma \sqrt {2\pi}}}\exp\left\{{-\frac{(y_i - \mu)^2}{2\sigma^2}}\right\}.
\]</span>

Essendo le variabili i.i.d., possiamo scrivere la densità congiunta come il prodotto delle singole densità e quindi si ottiene
<span class="math display">\[
p(y \mid \mu) = \, \prod_{i=1}^n p(y_i \mid \mu).
\]</span></p>
<p>Una volta osservati i dati <span class="math inline">\(y\)</span>, la verosimiglianza diventa</p>
<p><span class="math display">\[\begin{align}
\mathcal{L}(\mu \mid y) =&amp; \, \prod_{i=1}^n p(y_i \mid \mu) = \notag\\
&amp; \frac{1}{{\sigma \sqrt {2\pi}}}\exp\left\{{-\frac{(y_1 - \mu)^2}{2\sigma^2}}\right\} \times \notag\\
 &amp; \frac{1}{{\sigma \sqrt {2\pi}}}\exp\left\{{-\frac{(y_2 - \mu)^2}{2\sigma^2}}\right\} \times  \notag\\
&amp; \vdots \notag\\
 &amp; \frac{1}{{\sigma \sqrt {2\pi}}}\exp\left\{{-\frac{(y_n - \mu)^2}{2\sigma^2}}\right\}.
\end{align}\]</span></p>
<p>Se viene scelta una densità a priori Normale, ciò fa sì che anche la densità a posteriori sia Normale. Supponiamo che
<span class="math display" id="eq:prior-mu-norm-norm">\[\begin{equation}
p(\mu) = \frac{1}{{\tau_0 \sqrt {2\pi}}}\exp\left\{{-\frac{(\mu - \mu_0)^2}{2\tau_0^2}}\right\},
\tag{2.1}
\end{equation}\]</span>

ovvero che la distribuzione a priori di <span class="math inline">\(\mu\)</span> sia Normale con media <span class="math inline">\(\mu_0\)</span> e varianza <span class="math inline">\(\tau_0^2\)</span>. Possiamo dire che <span class="math inline">\(\mu_0\)</span> rappresenta il valore ritenuto più probabile per <span class="math inline">\(\mu\)</span> e <span class="math inline">\(\tau_0^2\)</span> il grado di incertezza che abbiamo rispetto a tale valore.</p>
<p>Svolgendo una serie di passaggi algebrici, si arriva a
<span class="math display" id="eq:post-norm-norm">\[\begin{equation}
p(\mu \mid y) = \frac{1}{{\tau_p \sqrt {2\pi}}}\exp\left\{{-\frac{(\mu - \mu_p)^2}{2\tau_p^2}}\right\},
\tag{2.2}
\end{equation}\]</span></p>
<p>
dove
<span class="math display" id="eq:post-norm-mup">\[\begin{equation}
\mu_p = \frac{\frac{1}{\tau_0^2}\mu_0+ \frac{n}{\sigma^2}\bar{y}}{\frac {1}{\tau_0^2} + \frac{n}{\sigma^2}} 
\tag{2.3}
\end{equation}\]</span></p>
<p>
e
<span class="math display" id="eq:post-norm-taup2">\[\begin{equation}
\tau_p^2 = \frac{1}{\frac {1}{\tau_0^2}+ \frac{n}{\sigma^2}}.
\tag{2.4}
\end{equation}\]</span></p>
<p>
In altri termini, se la distribuzione a priori per <span class="math inline">\(\mu\)</span> è Normale, la distribuzione a posteriori è anch’essa Normale con valore atteso (a posteriori) <span class="math inline">\(\mu_p\)</span> e varianza (a posteriori) <span class="math inline">\(\tau_p^2\)</span> date dalle espressioni precedenti.</p>
<p>In conclusione, il risultato trovato indica che:</p>
<ul>
<li>il valore atteso a posteriori è una media pesata fra il valore atteso a priori <span class="math inline">\(\mu_0\)</span> e la media campionaria <span class="math inline">\(\bar{y}\)</span>; il peso della media campionaria è tanto maggiore tanto più è grande <span class="math inline">\(n\)</span> (il numero di osservazioni) e <span class="math inline">\(\tau_0^2\)</span> (l’incertezza iniziale);</li>
<li>l’incertezza (varianza) a posteriori <span class="math inline">\(\tau_p^2\)</span> è sempre più piccola dell’incertezza a priori <span class="math inline">\(\tau_0^2\)</span> e diminuisce al crescere di <span class="math inline">\(n\)</span>.</li>
</ul>
</div>
<div id="il-modello-normale-con-stan" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Il modello Normale con Stan</h2>
<p>Per esaminare un esempio pratico, consideriamo i 30 valori BDI-II dei soggetti clinici di <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="modello-bayesiano-normale-normale.html#cb1-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-2"><a href="modello-bayesiano-normale-normale.html#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(</span>
<span id="cb1-3"><a href="modello-bayesiano-normale-normale.html#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="fl">26.0</span>, <span class="fl">35.0</span>, <span class="dv">30</span>, <span class="dv">25</span>, <span class="dv">44</span>, <span class="dv">30</span>, <span class="dv">33</span>, <span class="dv">43</span>, <span class="dv">22</span>, <span class="dv">43</span>, </span>
<span id="cb1-4"><a href="modello-bayesiano-normale-normale.html#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">24</span>, <span class="dv">19</span>, <span class="dv">39</span>, <span class="dv">31</span>, <span class="dv">25</span>, <span class="dv">28</span>, <span class="dv">35</span>, <span class="dv">30</span>, <span class="dv">26</span>, <span class="dv">31</span>, <span class="dv">41</span>, </span>
<span id="cb1-5"><a href="modello-bayesiano-normale-normale.html#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">36</span>, <span class="dv">26</span>, <span class="dv">35</span>, <span class="dv">33</span>, <span class="dv">28</span>, <span class="dv">27</span>, <span class="dv">34</span>, <span class="dv">27</span>, <span class="dv">22</span></span>
<span id="cb1-6"><a href="modello-bayesiano-normale-normale.html#cb1-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-7"><a href="modello-bayesiano-normale-normale.html#cb1-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>
Calcoliamo le statistiche descrittive del campione di dati:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="modello-bayesiano-normale-normale.html#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="modello-bayesiano-normale-normale.html#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb2-3"><a href="modello-bayesiano-normale-normale.html#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_mean =</span> <span class="fu">mean</span>(y),</span>
<span id="cb2-4"><a href="modello-bayesiano-normale-normale.html#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_sd =</span> <span class="fu">sd</span>(y)</span>
<span id="cb2-5"><a href="modello-bayesiano-normale-normale.html#cb2-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-6"><a href="modello-bayesiano-normale-normale.html#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   sample_mean sample_sd</span></span>
<span id="cb2-7"><a href="modello-bayesiano-normale-normale.html#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    30.93333  6.606858</span></span></code></pre></div>
<p>Nella discussione seguente assumeremo che <span class="math inline">\(\mu\)</span> e <span class="math inline">\(\sigma\)</span> siano indipendenti. Assegneremo a <span class="math inline">\(\mu\)</span> una distribuzione a priori <span class="math inline">\(\mathcal{N}(25, 5)\)</span> e a <span class="math inline">\(\sigma\)</span> una distribuzione a priori <span class="math inline">\(Cauchy(0, 5)\)</span>.</p>
<p>Il modello statistico diventa:</p>
<p><span class="math display">\[\begin{align}
Y_i &amp;\sim \mathcal{N}(\mu, \sigma) \notag\\
\mu &amp;\sim \mathcal{N}(\mu_{\mu} = 25, \sigma_{\mu} = 5) \notag\\
\sigma &amp;\sim \Cauchy(0, 5) \notag
\end{align}\]</span></p>
<p>In base al modello definito, la variabile casuale <span class="math inline">\(Y\)</span> segue la distribuzione Normale di parametri <span class="math inline">\(\mu\)</span> e <span class="math inline">\(\sigma\)</span>. Il parametro <span class="math inline">\(\mu\)</span> è sconosciuto e abbiamo deciso di descrivere la nostra incertezza relativa ad esso mediante una distribuzione a priori Normale con media uguale a 25 e deviazione standard pari a 5. L’incertezza relativa a <span class="math inline">\(\sigma\)</span> è quantificata da una distribuzione a priori half-Cauchy(0, 5), come indicato nella figura seguente:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="modello-bayesiano-normale-normale.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="modello-bayesiano-normale-normale.html#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb3-3"><a href="modello-bayesiano-normale-normale.html#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(</span>
<span id="cb3-4"><a href="modello-bayesiano-normale-normale.html#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> dcauchy, </span>
<span id="cb3-5"><a href="modello-bayesiano-normale-normale.html#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fl">1e3</span>, </span>
<span id="cb3-6"><a href="modello-bayesiano-normale-normale.html#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">args =</span> <span class="fu">list</span>(<span class="at">location =</span> <span class="dv">0</span>, <span class="at">scale =</span> <span class="dv">5</span>)</span>
<span id="cb3-7"><a href="modello-bayesiano-normale-normale.html#cb3-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-8"><a href="modello-bayesiano-normale-normale.html#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;P(x)&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-9"><a href="modello-bayesiano-normale-normale.html#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="050_modello_normale_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Dato che il modello è Normale-Normale, è possibile una soluzione analitica, come descritto in precedenza per il caso in cui <span class="math inline">\(\sigma\)</span> è noto. In tali condizioni, la distribuzione a posteriori per <span class="math inline">\(\mu\)</span> può essere trovata con la funzione <code>bayesrules:::summarize_normal_normal()</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="modello-bayesiano-normale-normale.html#cb4-1" aria-hidden="true" tabindex="-1"></a>bayesrules<span class="sc">:::</span><span class="fu">summarize_normal_normal</span>(</span>
<span id="cb4-2"><a href="modello-bayesiano-normale-normale.html#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">5</span>, <span class="at">sigma =</span> <span class="fl">6.61</span>, <span class="at">y_bar =</span> <span class="fl">30.93</span>, <span class="at">n =</span> <span class="dv">30</span></span>
<span id="cb4-3"><a href="modello-bayesiano-normale-normale.html#cb4-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-4"><a href="modello-bayesiano-normale-normale.html#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       model     mean     mode      var       sd</span></span>
<span id="cb4-5"><a href="modello-bayesiano-normale-normale.html#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     prior 25.00000 25.00000 25.00000 5.000000</span></span>
<span id="cb4-6"><a href="modello-bayesiano-normale-normale.html#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 posterior 30.60356 30.60356  1.37623 1.173128</span></span></code></pre></div>
<p>La rappresentazione grafica della funzione a priori, della verosimiglianza e della distribuzione a posteriori per <span class="math inline">\(\mu\)</span> è fornita da:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="modello-bayesiano-normale-normale.html#cb5-1" aria-hidden="true" tabindex="-1"></a>bayesrules<span class="sc">:::</span><span class="fu">plot_normal_normal</span>(</span>
<span id="cb5-2"><a href="modello-bayesiano-normale-normale.html#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">5</span>, <span class="at">sigma =</span> <span class="fl">6.61</span>, <span class="at">y_bar =</span> <span class="fl">30.93</span>, <span class="at">n =</span> <span class="dv">30</span></span>
<span id="cb5-3"><a href="modello-bayesiano-normale-normale.html#cb5-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="050_modello_normale_files/figure-html/unnamed-chunk-6-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>La procedura MCMC utilizzata da Stan è basata su un campionamento Monte Carlo Hamiltoniano che non richiede l’uso di distribuzioni a priori coniugate. Pertanto per i parametri è possibile scegliere una qualunque distribuzione a priori arbitraria.</p>
<p>Per trovare le distribuzioni a posteriori dei parametri <span class="math inline">\(\mu\)</span> e <span class="math inline">\(\sigma\)</span>, useremo le funzioni del pacchetto <code>cmdstanr</code>. Il modello statistico descritto sopra si può scrivere in Stan nel modo seguente:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="modello-bayesiano-normale-normale.html#cb6-1" aria-hidden="true" tabindex="-1"></a>modelString <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb6-2"><a href="modello-bayesiano-normale-normale.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb6-3"><a href="modello-bayesiano-normale-normale.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; N;</span></span>
<span id="cb6-4"><a href="modello-bayesiano-normale-normale.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[N] y;</span></span>
<span id="cb6-5"><a href="modello-bayesiano-normale-normale.html#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb6-6"><a href="modello-bayesiano-normale-normale.html#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb6-7"><a href="modello-bayesiano-normale-normale.html#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="st">  real mu;</span></span>
<span id="cb6-8"><a href="modello-bayesiano-normale-normale.html#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma;</span></span>
<span id="cb6-9"><a href="modello-bayesiano-normale-normale.html#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb6-10"><a href="modello-bayesiano-normale-normale.html#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb6-11"><a href="modello-bayesiano-normale-normale.html#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="st">  mu ~ normal(25, 10);</span></span>
<span id="cb6-12"><a href="modello-bayesiano-normale-normale.html#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="st">  sigma ~ cauchy(0, 10);</span></span>
<span id="cb6-13"><a href="modello-bayesiano-normale-normale.html#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="st">  y ~ normal(mu, sigma);</span></span>
<span id="cb6-14"><a href="modello-bayesiano-normale-normale.html#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb6-15"><a href="modello-bayesiano-normale-normale.html#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb6-16"><a href="modello-bayesiano-normale-normale.html#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(modelString, <span class="at">con =</span> <span class="st">&quot;code/normalmodel.stan&quot;</span>)</span></code></pre></div>
<p>Sistemiamo i dati nel formato appropriato per potere essere letti da Stan:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="modello-bayesiano-normale-normale.html#cb7-1" aria-hidden="true" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb7-2"><a href="modello-bayesiano-normale-normale.html#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">length</span>(df<span class="sc">$</span>y),</span>
<span id="cb7-3"><a href="modello-bayesiano-normale-normale.html#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> df<span class="sc">$</span>y</span>
<span id="cb7-4"><a href="modello-bayesiano-normale-normale.html#cb7-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Leggiamo il file in cui abbiamo salvato il codice Stan</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="modello-bayesiano-normale-normale.html#cb8-1" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;code&quot;</span>, <span class="st">&quot;normalmodel.stan&quot;</span>)</span></code></pre></div>
<p>compiliamo il modello</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="modello-bayesiano-normale-normale.html#cb9-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file)</span></code></pre></div>
<p>ed eseguiamo il campionamento MCMC</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="modello-bayesiano-normale-normale.html#cb10-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb10-2"><a href="modello-bayesiano-normale-normale.html#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_list,</span>
<span id="cb10-3"><a href="modello-bayesiano-normale-normale.html#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> 4000L,</span>
<span id="cb10-4"><a href="modello-bayesiano-normale-normale.html#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> 2000L,</span>
<span id="cb10-5"><a href="modello-bayesiano-normale-normale.html#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> SEED,</span>
<span id="cb10-6"><a href="modello-bayesiano-normale-normale.html#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> 4L,</span>
<span id="cb10-7"><a href="modello-bayesiano-normale-normale.html#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel_chains =</span> 2L,</span>
<span id="cb10-8"><a href="modello-bayesiano-normale-normale.html#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb10-9"><a href="modello-bayesiano-normale-normale.html#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin =</span> <span class="dv">1</span></span>
<span id="cb10-10"><a href="modello-bayesiano-normale-normale.html#cb10-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-11"><a href="modello-bayesiano-normale-normale.html#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Running MCMC with 4 chains, at most 2 in parallel...</span></span>
<span id="cb10-12"><a href="modello-bayesiano-normale-normale.html#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-13"><a href="modello-bayesiano-normale-normale.html#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1 finished in 0.1 seconds.</span></span>
<span id="cb10-14"><a href="modello-bayesiano-normale-normale.html#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2 finished in 0.1 seconds.</span></span>
<span id="cb10-15"><a href="modello-bayesiano-normale-normale.html#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3 finished in 0.1 seconds.</span></span>
<span id="cb10-16"><a href="modello-bayesiano-normale-normale.html#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4 finished in 0.1 seconds.</span></span>
<span id="cb10-17"><a href="modello-bayesiano-normale-normale.html#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-18"><a href="modello-bayesiano-normale-normale.html#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; All 4 chains finished successfully.</span></span>
<span id="cb10-19"><a href="modello-bayesiano-normale-normale.html#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean chain execution time: 0.1 seconds.</span></span>
<span id="cb10-20"><a href="modello-bayesiano-normale-normale.html#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Total execution time: 0.4 seconds.</span></span></code></pre></div>
<p>Le stime a posteriori dei parametri si ottengono con:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="modello-bayesiano-normale-normale.html#cb11-1" aria-hidden="true" tabindex="-1"></a>fit<span class="sc">$</span><span class="fu">summary</span>(<span class="fu">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>))</span>
<span id="cb11-2"><a href="modello-bayesiano-normale-normale.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 10</span></span>
<span id="cb11-3"><a href="modello-bayesiano-normale-normale.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   variable  mean median    sd   mad    q5   q95  rhat</span></span>
<span id="cb11-4"><a href="modello-bayesiano-normale-normale.html#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb11-5"><a href="modello-bayesiano-normale-normale.html#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 mu       30.8   30.8  1.23  1.20  28.8  32.8   1.00</span></span>
<span id="cb11-6"><a href="modello-bayesiano-normale-normale.html#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 sigma     6.83   6.72 0.931 0.894  5.49  8.50  1.00</span></span>
<span id="cb11-7"><a href="modello-bayesiano-normale-normale.html#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 2 more variables: ess_bulk &lt;dbl&gt;, ess_tail &lt;dbl&gt;</span></span></code></pre></div>
<p>
oppure, dopo avere trasformato l’oggetto <code>fit</code> nel formato <code>stanfit</code>,</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="modello-bayesiano-normale-normale.html#cb12-1" aria-hidden="true" tabindex="-1"></a>stanfit <span class="ot">&lt;-</span> rstan<span class="sc">::</span><span class="fu">read_stan_csv</span>(fit<span class="sc">$</span><span class="fu">output_files</span>())</span></code></pre></div>
<p>
con</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="modello-bayesiano-normale-normale.html#cb13-1" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> rstantools<span class="sc">::</span><span class="fu">posterior_interval</span>(<span class="fu">as.matrix</span>(stanfit), <span class="at">prob =</span> <span class="fl">0.95</span>)</span>
<span id="cb13-2"><a href="modello-bayesiano-normale-normale.html#cb13-2" aria-hidden="true" tabindex="-1"></a>out</span>
<span id="cb13-3"><a href="modello-bayesiano-normale-normale.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            2.5%      97.5%</span></span>
<span id="cb13-4"><a href="modello-bayesiano-normale-normale.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu     28.38840  33.271595</span></span>
<span id="cb13-5"><a href="modello-bayesiano-normale-normale.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma   5.29920   8.911617</span></span>
<span id="cb13-6"><a href="modello-bayesiano-normale-normale.html#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lp__  -73.60881 -69.814000</span></span></code></pre></div>
<p>Possiamo dunque concludere, con un grado di certezza soggettivo del 95%, che siamo sicuri che la media della popolazione da cui abbiamo tratto i dati è compresa nell’intervallo [28.39, 33.27].</p>
</div>
<div id="il-modello-normale-con-quap" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Il modello normale con <code>quap()</code></h2>
<p>Ripetiamo l’analisi precedente usando le funzioni del pacchetto <code>rethinking</code> per trovare la distribuzione a posteriori dei parametri <span class="math inline">\(\mu\)</span> e <span class="math inline">\(\sigma\)</span>. Definiamo il modello statistico mediante la funzione <code>alist()</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="modello-bayesiano-normale-normale.html#cb14-1" aria-hidden="true" tabindex="-1"></a>flist <span class="ot">&lt;-</span> <span class="fu">alist</span>(</span>
<span id="cb14-2"><a href="modello-bayesiano-normale-normale.html#cb14-2" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma), </span>
<span id="cb14-3"><a href="modello-bayesiano-normale-normale.html#cb14-3" aria-hidden="true" tabindex="-1"></a>  mu <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">25</span>, <span class="dv">10</span>),</span>
<span id="cb14-4"><a href="modello-bayesiano-normale-normale.html#cb14-4" aria-hidden="true" tabindex="-1"></a>  sigma <span class="sc">~</span> <span class="fu">dcauchy</span>(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb14-5"><a href="modello-bayesiano-normale-normale.html#cb14-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Le precedenti istruzioni <code>R</code> specificano una variabile casuale <span class="math inline">\(Y\)</span> che si distribuisce come una Normale di parametri <span class="math inline">\(\mu\)</span> e <span class="math inline">\(\sigma\)</span>; questa è la verosimiglianza. La distribuzione a priori del parametro <span class="math inline">\(\mu\)</span> è una Normale di media 25 e deviazione standard 10. La distribuzione a priori del parametro <span class="math inline">\(\sigma\)</span> è una half-Cauchy di parametri <code>location</code> = 0 e <code>scale</code> = 10.</p>
<p>Usiamo la funzione <code>quap()</code> per ottenere l’approssimazione quadratica delle distribuzioni a posteriori di <span class="math inline">\(\mu\)</span> e <span class="math inline">\(\sigma\)</span>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="modello-bayesiano-normale-normale.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb15-2"><a href="modello-bayesiano-normale-normale.html#cb15-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb15-3"><a href="modello-bayesiano-normale-normale.html#cb15-3" aria-hidden="true" tabindex="-1"></a>  flist,</span>
<span id="cb15-4"><a href="modello-bayesiano-normale-normale.html#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df </span>
<span id="cb15-5"><a href="modello-bayesiano-normale-normale.html#cb15-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>L’intervallo di credibilità al 95% è dato dalla funzione <code>precis()</code>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="modello-bayesiano-normale-normale.html#cb16-1" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">precis</span>(m, <span class="at">prob =</span> <span class="fl">0.95</span>)</span>
<span id="cb16-2"><a href="modello-bayesiano-normale-normale.html#cb16-2" aria-hidden="true" tabindex="-1"></a>out</span>
<span id="cb16-3"><a href="modello-bayesiano-normale-normale.html#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            mean        sd      2.5%     97.5%</span></span>
<span id="cb16-4"><a href="modello-bayesiano-normale-normale.html#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu    30.852580 1.1668054 28.565683 33.139476</span></span>
<span id="cb16-5"><a href="modello-bayesiano-normale-normale.html#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma  6.433829 0.8172245  4.832098  8.035559</span></span></code></pre></div>
<p>Possiamo dunque dire che, con un grado di certezza soggettivo del 95%, siamo sicuri che la media della popolazione da cui abbiamo tratto i dati è compresa nell’intervallo [28.57, 33.14].</p>
</div>
<div id="il-modello-normale-con-brm" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Il modello normale con <code>brm()</code></h2>
<p>Stimiamo ora la distribuzione a posteriori di <span class="math inline">\(\mu\)</span> usando nuovamente il campionamento MCMC mediante la funzione <code>brms::brm()</code>. In questo caso non è necessario scrivere il modello in linguaggio Stan come abbiamo fatto in precedenza. La sintassi specifiata di seguito viene comunque trasformata in linguaggio Stan prima di adattare il modello ai dati:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="modello-bayesiano-normale-normale.html#cb17-1" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb17-2"><a href="modello-bayesiano-normale-normale.html#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df, </span>
<span id="cb17-3"><a href="modello-bayesiano-normale-normale.html#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb17-4"><a href="modello-bayesiano-normale-normale.html#cb17-4" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb17-5"><a href="modello-bayesiano-normale-normale.html#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb17-6"><a href="modello-bayesiano-normale-normale.html#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">25</span>, <span class="dv">10</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb17-7"><a href="modello-bayesiano-normale-normale.html#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> sigma)</span>
<span id="cb17-8"><a href="modello-bayesiano-normale-normale.html#cb17-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb17-9"><a href="modello-bayesiano-normale-normale.html#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">4000</span>, </span>
<span id="cb17-10"><a href="modello-bayesiano-normale-normale.html#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span>, </span>
<span id="cb17-11"><a href="modello-bayesiano-normale-normale.html#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span></span>
<span id="cb17-12"><a href="modello-bayesiano-normale-normale.html#cb17-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>
I trace-plot si ottengono con l’istruzione seguente:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="modello-bayesiano-normale-normale.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit3)</span></code></pre></div>
<p><img src="050_modello_normale_files/figure-html/unnamed-chunk-19-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>
Le stime della distribuzione a posteriori si ottengono con la funzione <code>summary()</code>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="modello-bayesiano-normale-normale.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3)</span>
<span id="cb19-2"><a href="modello-bayesiano-normale-normale.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Family: gaussian </span></span>
<span id="cb19-3"><a href="modello-bayesiano-normale-normale.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Links: mu = identity; sigma = identity </span></span>
<span id="cb19-4"><a href="modello-bayesiano-normale-normale.html#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: y ~ 1 </span></span>
<span id="cb19-5"><a href="modello-bayesiano-normale-normale.html#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Data: df (Number of observations: 30) </span></span>
<span id="cb19-6"><a href="modello-bayesiano-normale-normale.html#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;</span></span>
<span id="cb19-7"><a href="modello-bayesiano-normale-normale.html#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          total post-warmup draws = 8000</span></span>
<span id="cb19-8"><a href="modello-bayesiano-normale-normale.html#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-9"><a href="modello-bayesiano-normale-normale.html#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Population-Level Effects: </span></span>
<span id="cb19-10"><a href="modello-bayesiano-normale-normale.html#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Estimate Est.Error l-95% CI u-95% CI Rhat</span></span>
<span id="cb19-11"><a href="modello-bayesiano-normale-normale.html#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Intercept    30.86      1.24    28.39    33.24 1.00</span></span>
<span id="cb19-12"><a href="modello-bayesiano-normale-normale.html#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Bulk_ESS Tail_ESS</span></span>
<span id="cb19-13"><a href="modello-bayesiano-normale-normale.html#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Intercept     6137     4967</span></span>
<span id="cb19-14"><a href="modello-bayesiano-normale-normale.html#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-15"><a href="modello-bayesiano-normale-normale.html#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Family Specific Parameters: </span></span>
<span id="cb19-16"><a href="modello-bayesiano-normale-normale.html#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS</span></span>
<span id="cb19-17"><a href="modello-bayesiano-normale-normale.html#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma     6.80      0.92     5.29     8.89 1.00     5136</span></span>
<span id="cb19-18"><a href="modello-bayesiano-normale-normale.html#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Tail_ESS</span></span>
<span id="cb19-19"><a href="modello-bayesiano-normale-normale.html#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma     4234</span></span>
<span id="cb19-20"><a href="modello-bayesiano-normale-normale.html#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-21"><a href="modello-bayesiano-normale-normale.html#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb19-22"><a href="modello-bayesiano-normale-normale.html#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb19-23"><a href="modello-bayesiano-normale-normale.html#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre></div>
<p>
I risultati sono molto simili a quelli ottenuti in precedenza.</p>
</div>
<div id="considerazioni-conclusive" class="section level2 unnumbered">
<h2>Considerazioni conclusive</h2>
<p>Questo esempio ci mostra come calcolare l’intervallo di credibilità per la media di una v.a. Normale. La domanda più ovvia di analisi dei dati, dopo avere visto come creare l’intervallo di credibilità per la media di un gruppo, riguarda il confronto tra le medie di due gruppi. Questo però è un caso speciale di una tecnica di analisi dei dati più generale, chiamate analisi di regressione lineare. Prima di discutere il problema del confronto tra le medie di due gruppi è dunque necessario esaminare il modello statistico di regressione lineare.</p>

<div id="refs" class="references csl-bib-body hanging-indent">
<div class="csl-entry">
Zetsche, Ulrike, Paul-Christian Bürkner, and Babette Renneberg. 2019. <span>“Future Expectations in Clinical Depression: <span>Biased</span> or Realistic?”</span> <em>Journal of Abnormal Psychology</em> 128 (7): 678–88.
</div>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-zetschefuture2019" class="csl-entry">
Zetsche, Ulrike, Paul-Christian Bürkner, and Babette Renneberg. 2019. <span>“Future Expectations in Clinical Depression: <span>Biased</span> or Realistic?”</span> <em>Journal of Abnormal Psychology</em> 128 (7): 678–88.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/050_modello_normale.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Data Science per psicologi.pdf", "Data Science per psicologi.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
