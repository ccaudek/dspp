<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capitolo 4 Confronto tra due gruppi indipendenti | Data Science per psicologi</title>
  <meta name="description" content="Capitolo 4 Confronto tra due gruppi indipendenti | Data Science per psicologi si propone di fornire un’introduzione all’analisi dei dati psicologici agli studenti del primo anno del Corso di Laurea in Scienze e Tecniche Psicologiche presso l’Università degli Studi di Firenze. Particolare attenzione sarà posta ai seguenti aspetti: l’uso del linguaggio R per lo svolgimento delle analisi statistiche, la rappresentazione grafica dei dati e l’inferenza Bayesiana." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Capitolo 4 Confronto tra due gruppi indipendenti | Data Science per psicologi" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Capitolo 4 Confronto tra due gruppi indipendenti | Data Science per psicologi si propone di fornire un’introduzione all’analisi dei dati psicologici agli studenti del primo anno del Corso di Laurea in Scienze e Tecniche Psicologiche presso l’Università degli Studi di Firenze. Particolare attenzione sarà posta ai seguenti aspetti: l’uso del linguaggio R per lo svolgimento delle analisi statistiche, la rappresentazione grafica dei dati e l’inferenza Bayesiana." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capitolo 4 Confronto tra due gruppi indipendenti | Data Science per psicologi" />
  
  <meta name="twitter:description" content="Capitolo 4 Confronto tra due gruppi indipendenti | Data Science per psicologi si propone di fornire un’introduzione all’analisi dei dati psicologici agli studenti del primo anno del Corso di Laurea in Scienze e Tecniche Psicologiche presso l’Università degli Studi di Firenze. Particolare attenzione sarà posta ai seguenti aspetti: l’uso del linguaggio R per lo svolgimento delle analisi statistiche, la rappresentazione grafica dei dati e l’inferenza Bayesiana." />
  

<meta name="author" content="Corrado Caudek" />


<meta name="date" content="2021-09-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="inferenza-sul-modello-di-regressione.html"/>

<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science per psicologi</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="regr-models-intro.html"><a href="regr-models-intro.html"><i class="fa fa-check"></i><b>1</b> Introduzione alla regressione lineare bayesiana</a>
<ul>
<li class="chapter" data-level="1.1" data-path="regr-models-intro.html"><a href="regr-models-intro.html#la-funzione-lineare"><i class="fa fa-check"></i><b>1.1</b> La funzione lineare</a></li>
<li class="chapter" data-level="1.2" data-path="regr-models-intro.html"><a href="regr-models-intro.html#lerrore-di-misurazione"><i class="fa fa-check"></i><b>1.2</b> L’errore di misurazione</a></li>
<li class="chapter" data-level="1.3" data-path="regr-models-intro.html"><a href="regr-models-intro.html#il-modello-di-regressione-da-una-prospettiva-bayesiana"><i class="fa fa-check"></i><b>1.3</b> Il modello di regressione da una prospettiva bayesiana</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="regr-models-intro.html"><a href="regr-models-intro.html#una-media-specifica-per-ciascuna-osservazione"><i class="fa fa-check"></i><b>1.3.1</b> Una media specifica per ciascuna osservazione</a></li>
<li class="chapter" data-level="1.3.2" data-path="regr-models-intro.html"><a href="regr-models-intro.html#relazione-lineare-tra-la-media-e-il-predittore"><i class="fa fa-check"></i><b>1.3.2</b> Relazione lineare tra la media e il predittore</a></li>
<li class="chapter" data-level="1.3.3" data-path="regr-models-intro.html"><a href="regr-models-intro.html#il-modello-di-regressione-lineare"><i class="fa fa-check"></i><b>1.3.3</b> Il modello di regressione lineare</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="regr-models-intro.html"><a href="regr-models-intro.html#considerazioni-conclusive"><i class="fa fa-check"></i>Considerazioni conclusive</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="regressione-lineare-con-stan.html"><a href="regressione-lineare-con-stan.html"><i class="fa fa-check"></i><b>2</b> Regressione lineare con Stan</a>
<ul>
<li class="chapter" data-level="2.1" data-path="regressione-lineare-con-stan.html"><a href="regressione-lineare-con-stan.html#interpretazione-dei-parametri"><i class="fa fa-check"></i><b>2.1</b> Interpretazione dei parametri</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="regressione-lineare-con-stan.html"><a href="regressione-lineare-con-stan.html#centrare-i-predittori"><i class="fa fa-check"></i><b>2.1.1</b> Centrare i predittori</a></li>
<li class="chapter" data-level="2.1.2" data-path="regressione-lineare-con-stan.html"><a href="regressione-lineare-con-stan.html#rappresentazione-grafica-dellincertezza-della-stima"><i class="fa fa-check"></i><b>2.1.2</b> Rappresentazione grafica dell’incertezza della stima</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="regressione-lineare-con-stan.html"><a href="regressione-lineare-con-stan.html#minimi-quadrati"><i class="fa fa-check"></i><b>2.2</b> Minimi quadrati</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="regressione-lineare-con-stan.html"><a href="regressione-lineare-con-stan.html#massima-verosimiglianza"><i class="fa fa-check"></i><b>2.2.1</b> Massima verosimiglianza</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="inferenza-sul-modello-di-regressione.html"><a href="inferenza-sul-modello-di-regressione.html"><i class="fa fa-check"></i><b>3</b> Inferenza sul modello di regressione</a>
<ul>
<li class="chapter" data-level="3.1" data-path="inferenza-sul-modello-di-regressione.html"><a href="inferenza-sul-modello-di-regressione.html#rappresentazione-grafica-dellincertezza-della-stima-1"><i class="fa fa-check"></i><b>3.1</b> Rappresentazione grafica dell’incertezza della stima</a></li>
<li class="chapter" data-level="3.2" data-path="inferenza-sul-modello-di-regressione.html"><a href="inferenza-sul-modello-di-regressione.html#intervalli-di-credibilità"><i class="fa fa-check"></i><b>3.2</b> Intervalli di credibilità</a></li>
<li class="chapter" data-level="3.3" data-path="inferenza-sul-modello-di-regressione.html"><a href="inferenza-sul-modello-di-regressione.html#rappresentazione-grafica-della-distribuzione-a-posteriori"><i class="fa fa-check"></i><b>3.3</b> Rappresentazione grafica della distribuzione a posteriori</a></li>
<li class="chapter" data-level="3.4" data-path="inferenza-sul-modello-di-regressione.html"><a href="inferenza-sul-modello-di-regressione.html#test-di-ipotesi"><i class="fa fa-check"></i><b>3.4</b> Test di ipotesi</a></li>
<li class="chapter" data-level="3.5" data-path="inferenza-sul-modello-di-regressione.html"><a href="inferenza-sul-modello-di-regressione.html#regressione-robusta"><i class="fa fa-check"></i><b>3.5</b> Regressione robusta</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="confronto-tra-due-gruppi-indipendenti.html"><a href="confronto-tra-due-gruppi-indipendenti.html"><i class="fa fa-check"></i><b>4</b> Confronto tra due gruppi indipendenti</a>
<ul>
<li class="chapter" data-level="4.1" data-path="confronto-tra-due-gruppi-indipendenti.html"><a href="confronto-tra-due-gruppi-indipendenti.html#regressione-lineare-con-una-variabile-dicotomica"><i class="fa fa-check"></i><b>4.1</b> Regressione lineare con una variabile dicotomica</a></li>
<li class="chapter" data-level="4.2" data-path="confronto-tra-due-gruppi-indipendenti.html"><a href="confronto-tra-due-gruppi-indipendenti.html#la-dimensione-delleffetto"><i class="fa fa-check"></i><b>4.2</b> La dimensione dell’effetto</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science per psicologi</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="confronto-tra-due-gruppi-indipendenti" class="section level1" number="4">
<h1><span class="header-section-number">Capitolo 4</span> Confronto tra due gruppi indipendenti</h1>
<p>Il problema del confronto tra due gruppi indipendenti può essere formulato nei termini di un modello di regressione nel quale la variabile <span class="math inline">\(x\)</span> è dicotomica, ovvero assume solo due valori.</p>
<div id="regressione-lineare-con-una-variabile-dicotomica" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Regressione lineare con una variabile dicotomica</h2>
<p>Se <span class="math inline">\(x\)</span> è una variabile dicotomica con valori 0 e 1, allora per il modello di regressione <span class="math inline">\(\mu_i = \alpha + \beta x_i\)</span> abbiamo quanto segue. Quando <span class="math inline">\(x=0\)</span>, il modello diventa</p>
<p><span class="math display">\[\mu_i = \alpha\]</span>

mentre, quando <span class="math inline">\(X=1\)</span>, il modello diventa</p>
<p><span class="math display">\[\mu_i = \alpha + \beta.\]</span>

Ciò significa che il parametro <span class="math inline">\(\alpha\)</span> è uguale alla media del gruppo codificato con <span class="math inline">\(X=0\)</span> e il parametro <span class="math inline">\(\beta\)</span> è uguale alla differenza tra le medie dei due gruppi (essendo la media del secondo gruppo uguale a <span class="math inline">\(\alpha + \beta\)</span>). Il parametro <span class="math inline">\(\beta\)</span>, dunque, codifica l’effetto di una manipolazione sperimentale o di un trattamento, e l’inferenza su <span class="math inline">\(\beta\)</span> corrisponde direttamente all’inferenza sull’efficacia di un trattamento. Per “effetto di un trattamento” si intende la differenza tra le medie di due gruppi (per esempio, il gruppo “sperimentale” e il gruppo “di controllo”). L’inferenza su <span class="math inline">\(\beta\)</span>, dunque, viene utilizzata per capire quanto “robusto” può essere considerato l’effetto di un trattamento o di una manipolazione sperimentale.</p>
<p>Esaminiamo nuovamente un sottoinsieme di dati tratto dal <em>National Longitudinal Survey of Youth</em> i quali sono stati discussi da <span class="citation"><a href="#ref-gelman2020regression" role="doc-biblioref">Gelman, Hill, and Vehtari</a> (<a href="#ref-gelman2020regression" role="doc-biblioref">2020</a>)</span>. I soggetti sono bambini di 3 e 4 anni. La variabile dipendente, <code>kid_score</code>, è il punteggio totale del <em>Peabody Individual Achievement Test</em> (PIAT) costituito dalla somma dei punteggi di tre sottoscale (Mathematics, Reading comprehension, Reading recognition). La variabile indipendente, <code>mom_hs</code>, è il livello di istruzione della madre, codificato con due livelli: scuola media superiore completata oppure no. La domanda della ricerca è se il QI del figlio (misurato sulla scala PIAT) risulta o meno associato al livello di istruzione della madre.</p>
<p>Codifichiamo il livello di istruzione della madre (<span class="math inline">\(x\)</span>) con una <em>variabile indicatrice</em> (ovvero, una variabile che assume solo i valori 0 e 1) tale per cui:</p>
<ul>
<li><p><span class="math inline">\(x=0\)</span>: la madre non ha completato la scuola secondaria di secondo grado (scuola media superiore);</p></li>
<li><p><span class="math inline">\(x=1\)</span>: la madre ha completato la scuola media superiore.</p></li>
</ul>
<p>
Supponiamo che i dati siano contenuti nel data.frame <code>df</code>.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="confronto-tra-due-gruppi-indipendenti.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;foreign&quot;</span>)</span>
<span id="cb39-2"><a href="confronto-tra-due-gruppi-indipendenti.html#cb39-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;kidiq.dta&quot;</span>))</span></code></pre></div>
<p>
Calcoliamo le statistiche descrittive per i due gruppi:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="confronto-tra-due-gruppi-indipendenti.html#cb40-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="confronto-tra-due-gruppi-indipendenti.html#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mom_hs) <span class="sc">%&gt;%</span> </span>
<span id="cb40-3"><a href="confronto-tra-due-gruppi-indipendenti.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb40-4"><a href="confronto-tra-due-gruppi-indipendenti.html#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_kid_score =</span> <span class="fu">mean</span>(kid_score),</span>
<span id="cb40-5"><a href="confronto-tra-due-gruppi-indipendenti.html#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">std =</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(kid_score))</span>
<span id="cb40-6"><a href="confronto-tra-due-gruppi-indipendenti.html#cb40-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-7"><a href="confronto-tra-due-gruppi-indipendenti.html#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 3</span></span>
<span id="cb40-8"><a href="confronto-tra-due-gruppi-indipendenti.html#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   mom_hs mean_kid_score   std</span></span>
<span id="cb40-9"><a href="confronto-tra-due-gruppi-indipendenti.html#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;          &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb40-10"><a href="confronto-tra-due-gruppi-indipendenti.html#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1      0           77.5  22.6</span></span>
<span id="cb40-11"><a href="confronto-tra-due-gruppi-indipendenti.html#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2      1           89.3  19.0</span></span></code></pre></div>
<p>
Il punteggio medio PIAT è pari a 77.5 per i bambini la cui madre non ha il diploma di scuola media superiore e pari a 89.3 per i bambini la cui madre ha completato la scuola media superiore. Questa differenza suggerisce un’associazione tra le variabili, ma tale differenza potrebbe essere soltanto la conseguenza della variabilità campionaria, senza riflettere una caratteristica generale della popolazione. Come possiamo usare il modello statistico lineare per fare inferenza sulla differenza osservata tra i due gruppi? Non dobbiamo fare nient’altro che usare lo stesso modello di regressione che abbiamo definito in precedenza.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-1" aria-hidden="true" tabindex="-1"></a>modelString <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb41-2"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb41-3"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; N;</span></span>
<span id="cb41-4"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[N] y;</span></span>
<span id="cb41-5"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[N] x;</span></span>
<span id="cb41-6"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb41-7"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="st">transformed data {</span></span>
<span id="cb41-8"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[N] x_std;</span></span>
<span id="cb41-9"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[N] y_std;</span></span>
<span id="cb41-10"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="st">  x_std = (x - mean(x)) / sd(x);</span></span>
<span id="cb41-11"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="st">  y_std = (y - mean(y)) / sd(y);</span></span>
<span id="cb41-12"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb41-13"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb41-14"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="st">  real alpha_std;</span></span>
<span id="cb41-15"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="st">  real beta_std;</span></span>
<span id="cb41-16"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma_std;</span></span>
<span id="cb41-17"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb41-18"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb41-19"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="st">  alpha_std ~ normal(0, 2);</span></span>
<span id="cb41-20"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="st">  beta_std ~ normal(0, 2);</span></span>
<span id="cb41-21"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="st">  sigma_std ~ cauchy(0, 2);</span></span>
<span id="cb41-22"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="st">  y_std ~ normal(alpha_std + beta_std * x_std, sigma_std);</span></span>
<span id="cb41-23"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-23" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb41-24"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-24" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb41-25"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-25" aria-hidden="true" tabindex="-1"></a><span class="st">  real alpha;</span></span>
<span id="cb41-26"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-26" aria-hidden="true" tabindex="-1"></a><span class="st">  real beta;</span></span>
<span id="cb41-27"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma;</span></span>
<span id="cb41-28"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-28" aria-hidden="true" tabindex="-1"></a><span class="st">  alpha = sd(y) * (alpha_std - beta_std * mean(x) / sd(x))</span></span>
<span id="cb41-29"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-29" aria-hidden="true" tabindex="-1"></a><span class="st">           + mean(y);</span></span>
<span id="cb41-30"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-30" aria-hidden="true" tabindex="-1"></a><span class="st">  beta = beta_std * sd(y) / sd(x);</span></span>
<span id="cb41-31"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-31" aria-hidden="true" tabindex="-1"></a><span class="st">  sigma = sd(y) * sigma_std;</span></span>
<span id="cb41-32"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-32" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb41-33"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-33" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb41-34"><a href="confronto-tra-due-gruppi-indipendenti.html#cb41-34" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(modelString, <span class="at">con =</span> <span class="st">&quot;code/simpleregstd.stan&quot;</span>)</span></code></pre></div>
<p>
Come in precedenza, salviamo i dati in un oggetto di classe <code>list</code>:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="confronto-tra-due-gruppi-indipendenti.html#cb42-1" aria-hidden="true" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb42-2"><a href="confronto-tra-due-gruppi-indipendenti.html#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">length</span>(df<span class="sc">$</span>kid_score),</span>
<span id="cb42-3"><a href="confronto-tra-due-gruppi-indipendenti.html#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> df<span class="sc">$</span>kid_score,</span>
<span id="cb42-4"><a href="confronto-tra-due-gruppi-indipendenti.html#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> df<span class="sc">$</span>mom_hs</span>
<span id="cb42-5"><a href="confronto-tra-due-gruppi-indipendenti.html#cb42-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>
Compiliamo il modello:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="confronto-tra-due-gruppi-indipendenti.html#cb43-1" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;code&quot;</span>, <span class="st">&quot;simpleregstd.stan&quot;</span>)</span>
<span id="cb43-2"><a href="confronto-tra-due-gruppi-indipendenti.html#cb43-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file)</span></code></pre></div>
<p>
Adattiamo il modello ai dati:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="confronto-tra-due-gruppi-indipendenti.html#cb44-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb44-2"><a href="confronto-tra-due-gruppi-indipendenti.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_list,</span>
<span id="cb44-3"><a href="confronto-tra-due-gruppi-indipendenti.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> 4000L,</span>
<span id="cb44-4"><a href="confronto-tra-due-gruppi-indipendenti.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> 2000L,</span>
<span id="cb44-5"><a href="confronto-tra-due-gruppi-indipendenti.html#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> SEED,</span>
<span id="cb44-6"><a href="confronto-tra-due-gruppi-indipendenti.html#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> 4L,</span>
<span id="cb44-7"><a href="confronto-tra-due-gruppi-indipendenti.html#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel_chains =</span> 2L,</span>
<span id="cb44-8"><a href="confronto-tra-due-gruppi-indipendenti.html#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb44-9"><a href="confronto-tra-due-gruppi-indipendenti.html#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin =</span> <span class="dv">1</span></span>
<span id="cb44-10"><a href="confronto-tra-due-gruppi-indipendenti.html#cb44-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="confronto-tra-due-gruppi-indipendenti.html#cb45-1" aria-hidden="true" tabindex="-1"></a>stanfit <span class="ot">&lt;-</span> rstan<span class="sc">::</span><span class="fu">read_stan_csv</span>(fit<span class="sc">$</span><span class="fu">output_files</span>())</span>
<span id="cb45-2"><a href="confronto-tra-due-gruppi-indipendenti.html#cb45-2" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> <span class="fu">extract</span>(stanfit)</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="confronto-tra-due-gruppi-indipendenti.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb46-2"><a href="confronto-tra-due-gruppi-indipendenti.html#cb46-2" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>kid_score <span class="sc">~</span> df<span class="sc">$</span>mom_hs, </span>
<span id="cb46-3"><a href="confronto-tra-due-gruppi-indipendenti.html#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb46-4"><a href="confronto-tra-due-gruppi-indipendenti.html#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;mom_hs&quot;</span>,</span>
<span id="cb46-5"><a href="confronto-tra-due-gruppi-indipendenti.html#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;kid_score&quot;</span></span>
<span id="cb46-6"><a href="confronto-tra-due-gruppi-indipendenti.html#cb46-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-7"><a href="confronto-tra-due-gruppi-indipendenti.html#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">mean</span>(posterior<span class="sc">$</span>alpha), <span class="fu">mean</span>(posterior<span class="sc">$</span>beta), <span class="at">col =</span> <span class="dv">6</span>, <span class="at">lw =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="054_reglin4_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>
Le stime a posteriori dei parametri si ottengono con:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="confronto-tra-due-gruppi-indipendenti.html#cb47-1" aria-hidden="true" tabindex="-1"></a>fit<span class="sc">$</span><span class="fu">summary</span>(<span class="fu">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sigma&quot;</span>))</span>
<span id="cb47-2"><a href="confronto-tra-due-gruppi-indipendenti.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 10</span></span>
<span id="cb47-3"><a href="confronto-tra-due-gruppi-indipendenti.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   variable  mean median    sd   mad    q5   q95  rhat</span></span>
<span id="cb47-4"><a href="confronto-tra-due-gruppi-indipendenti.html#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb47-5"><a href="confronto-tra-due-gruppi-indipendenti.html#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 alpha     77.5   77.6 2.07  2.06  74.2   81.0  1.00</span></span>
<span id="cb47-6"><a href="confronto-tra-due-gruppi-indipendenti.html#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 beta      11.8   11.8 2.34  2.33   7.91  15.6  1.00</span></span>
<span id="cb47-7"><a href="confronto-tra-due-gruppi-indipendenti.html#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 sigma     19.9   19.9 0.679 0.673 18.8   21.0  1.00</span></span>
<span id="cb47-8"><a href="confronto-tra-due-gruppi-indipendenti.html#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 2 more variables: ess_bulk &lt;dbl&gt;, ess_tail &lt;dbl&gt;</span></span></code></pre></div>
<p>
I risultati confermano ciò che ci aspettavamo:</p>
<ul>
<li>il coefficiente <span class="math inline">\(\texttt{alpha} = 77.56\)</span> corrisponde alla media del gruppo codificato con <span class="math inline">\(x = 0\)</span>, ovvero la media dei punteggi PIAT per i bambini la cui madre non ha completato la scuola media superiore;</li>
<li>il coefficiente <span class="math inline">\(\texttt{beta} = 11.76\)</span> corrisponde alla differenza tra le medie dei due gruppi, ovvero 89.32 - 77.55 = 11.77 (con piccoli errori di approssimazione).</li>
</ul>
<p>
Possiamo ottenere l’intervallo di credibilità al 95% per <span class="math inline">\(\texttt{beta}\)</span>:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="confronto-tra-due-gruppi-indipendenti.html#cb48-1" aria-hidden="true" tabindex="-1"></a>rstantools<span class="sc">::</span><span class="fu">posterior_interval</span>(<span class="fu">as.matrix</span>(stanfit), <span class="at">prob =</span> <span class="fl">0.95</span>)</span>
<span id="cb48-2"><a href="confronto-tra-due-gruppi-indipendenti.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   2.5%         97.5%</span></span>
<span id="cb48-3"><a href="confronto-tra-due-gruppi-indipendenti.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha_std   -0.0903768    0.09155991</span></span>
<span id="cb48-4"><a href="confronto-tra-due-gruppi-indipendenti.html#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta_std     0.1446650    0.32894522</span></span>
<span id="cb48-5"><a href="confronto-tra-due-gruppi-indipendenti.html#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma_std    0.9120478    1.04369125</span></span>
<span id="cb48-6"><a href="confronto-tra-due-gruppi-indipendenti.html#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha       73.4853725   81.60923250</span></span>
<span id="cb48-7"><a href="confronto-tra-due-gruppi-indipendenti.html#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta         7.1877393   16.34371250</span></span>
<span id="cb48-8"><a href="confronto-tra-due-gruppi-indipendenti.html#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma       18.6154975   21.30252500</span></span>
<span id="cb48-9"><a href="confronto-tra-due-gruppi-indipendenti.html#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lp__      -209.0430250 -204.32200000</span></span></code></pre></div>
<p>Il coefficiente <span class="math inline">\(b\)</span> ci dice che i bambini la cui madre ha completato la scuola superiore ottengono in media circa 12 punti in più rispetto ai bambini la cui madre non ha completato la scuola superiore. L’intervallo di credibilità al 95% ci dice che possiamo essere sicuri al 95% che tale differenza è di almeno 7 punti e può arrivare fino a ben 16 punti. Possiamo dunque concludere, con un grado di certezza soggettiva del 95%, che c’è un’associazione tra il livello di scolarità della madre e l’intelligenza del bambino: i bambini tendono ad avere un livello di intelligenza più elevato se le loro madri hanno un livello di istruzione maggiore.</p>
</div>
<div id="la-dimensione-delleffetto" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> La dimensione dell’effetto</h2>
<p>Avendo a disposizione le informazioni sulle distribuzioni a posteriori dei parametri è facile calcolare la dimensione dell’effetto nei termini del <span class="math inline">\(d\)</span> di Cohen:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="confronto-tra-due-gruppi-indipendenti.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fl">11.75398</span> <span class="sc">/</span> <span class="fl">19.90159</span> </span>
<span id="cb49-2"><a href="confronto-tra-due-gruppi-indipendenti.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.5906051</span></span></code></pre></div>
<p>
Nei termini del <span class="math inline">\(d\)</span> di Cohen possiamo dunque concludere che la grandezza dell’effetto è di entità “media” [<span class="math inline">\(d\)</span> &gt; 0.5; <a href="mailto:x@sawilowsky2009new" class="email">x@sawilowsky2009new</a>].</p>

<div id="refs" class="references csl-bib-body hanging-indent">
<div class="csl-entry">
Gelman, Andrew, Jennifer Hill, and Aki Vehtari. 2020. <em>Regression and Other Stories</em>. Cambridge University Press.
</div>
<div class="csl-entry">
Hambrick, DZ. 2015. <span>“Research Confirms a Link Between Intelligence and Life Expectancy.”</span> <em>Scientific American. Retrieved from Http://Www. Scientificamerican. Com/Article/Research-Confirms-a-Link-Between-Intelligence-and-Life-Expectancy</em>.
</div>
</div>
</div>
</div>







<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-gelman2020regression" class="csl-entry">
Gelman, Andrew, Jennifer Hill, and Aki Vehtari. 2020. <em>Regression and Other Stories</em>. Cambridge University Press.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="inferenza-sul-modello-di-regressione.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/054_reglin4.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Data Science per psicologi.pdf", "Data Science per psicologi.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
